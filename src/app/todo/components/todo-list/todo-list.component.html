<mat-toolbar color="primary">To-Do Lists</mat-toolbar>
<div fxLayout="column" fxLayoutGap="16px" style="padding: 16px">
  <mat-form-field appearance="fill" fxFlex>
    <mat-label>New list title</mat-label>
    <input matInput [(ngModel)]="newListTitle" />
  </mat-form-field>
  <button mat-raised-button color="primary" (click)="addList()">Add List</button>

  <div fxLayout="column" fxLayoutGap="16px">
    <cdk-accordion class="accordion">
      <cdk-accordion-item 
        *ngFor="let item of todos; let index = index" 
        [expanded]="expandedIndex === index" 
        class="accordion-item">
        <button
          class="accordion-item-header"
          (click)="toggleList(item.id, index)"
          tabindex="0"
          [attr.id]="'accordion-header-' + index"
          [attr.aria-expanded]="expandedIndex === index"
          [attr.aria-controls]="'accordion-body-' + index">
          {{ item.title }}
          <span class="accordion-item-description">
            Click to {{ expandedIndex === index ? 'close' : 'open' }}
          </span>
        </button>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="expandedIndex === index ? '' : 'none'"
          [attr.id]="'accordion-body-' + index"
          [attr.aria-labelledby]="'accordion-header-' + index">
          <div *ngIf="item.tasks?.length; else noTasks">
            <div *ngFor="let task of item.tasks">
              <mat-checkbox [checked]="task.completed" (change)="toggleTask(item.id, task)">
                {{ task.title }} - {{ task.description }}
              </mat-checkbox>
            </div>
          </div>
          <ng-template #noTasks>
            <p>No tasks found for this list.</p>
          </ng-template>
        </div>
      </cdk-accordion-item>
    </cdk-accordion>
  </div>
</div>